<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.16: http://docutils.sourceforge.net/" />
<title>Algebraic n-players Howson-Rosenthal theorem</title>
<meta name="date" content="RJCIA 2021" />
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="tango_subtle.css" type="text/css" />
<link rel="stylesheet" href="tango_subtle.min.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.12.0+0.12.1. Coq sources are in this panel; goals and messages will appear in the other. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus.</div><div class="document" id="algebraic-n-players-howson-rosenthal-theorem">
<h1 class="title">Algebraic n-players Howson-Rosenthal theorem</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="auteur field"><th class="docinfo-name">Auteur:</th><td class="field-body">Pierre Pomeret-Coquot</td>
</tr>
<tr><th class="docinfo-name">Date:</th>
<td>RJCIA 2021</td></tr>
</tbody>
</table>
<input type="checkbox" class="alectryon-toggle" id="alectryon-toggle-0" /><label for="alectryon-toggle-0" class="alectryon-toggle-label">Display all goals and responses</label><div class="alectryon-container docutils container">
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> Coq <span class="kn">Require Import</span> ssreflect.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Set Implicit Arguments</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Unset Strict Implicit</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Unset Printing Implicit Defensive</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">GeneralLemmae</span>.</span></span></span></pre><p>Decidability of eqTypes</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eqType_dec</span> (<span class="nv">T</span> : eqType) :
    <span class="kr">forall</span> <span class="nv">t1</span> <span class="nv">t2</span> : T, t1 = t2 \/ t1 &lt;&gt; t2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">t1</span> <span class="nv">t2</span> : T, t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">t1</span> <span class="nv">t2</span> : T, t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk2"><span class="highlight"><span class="nb">move</span> =&gt; t1 t2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1, t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">T</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk3"><span class="highlight"><span class="nb">case</span> (boolP (t1 == t2)) =&gt; /eqP H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1, t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t1 = t2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1, t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t1 &lt;&gt; t2</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk4"><hr></label><div class="goal-conclusion"><span class="highlight">t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk5"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1, t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t1 = t2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1, t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t1 &lt;&gt; t2</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk6"><hr></label><div class="goal-conclusion"><span class="highlight">t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk7"><span class="highlight"><span class="bp">exact</span>: or_introl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1, t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t1 &lt;&gt; t2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk8"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1, t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t1 &lt;&gt; t2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t1 = t2 \/ t1 &lt;&gt; t2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span>: or_intror.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">GeneralLemmae</span>.</span></span></span></pre><div class="section" id="evaluation-structure">
<h1>Evaluation structure</h1>
<p>Evaluation structure encapsulate domains, orders and operators for GEU:</p>
<ul class="simple">
<li>Utility domain U ordered by preceq_U</li>
<li>Plausibility domain W ordered by preceq_W</li>
<li>Valuation domain V ordered by preceq_V</li>
<li>otimes and oplus operators</li>
</ul>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">EvalStruct</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">eval_struct</span> : <span class="kt">Type</span> :=
    { U : finType ;
      W : eqType ;
      V : eqType ;
      V0 : V ;
      preceq_U : rel U ;
      preceq_W : rel W ;
      preceq_V : rel V ;
      oplus : Monoid.com_law V0 ;
      otimes : W -&gt; U -&gt; V ;
    }.</span></span></span></pre><p>Asymetric part of preceq</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">prec</span> <span class="nv">T</span> (<span class="nv">preceq</span> : rel T) : rel T :=
    <span class="kr">fun</span> <span class="nv">t1</span> <span class="nv">t2</span> =&gt; (preceq t1 t2) &amp;&amp; ~~ (preceq t2 t1).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">EvalStruct</span>.</span></span></span></pre></div>
<div class="section" id="games">
<h1>Games</h1>
<p>Three forms of games are defined in the corresponding modules:</p>
<ul class="simple">
<li>Standard Normal Form Games (NFGames)</li>
<li>Hypergraphical Games (HGGames)</li>
<li>Incomplete Games (IGames) (i.e. generalization of Bayesian games to any plausibility distribution)</li>
</ul>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Games</span>.</span></span></span></pre><div class="section" id="profiles">
<h2>Profiles</h2>
<p>A 'profile' is a dependent vector which contains a (X i) for all player i.
Typically, a strategy profile is a strategy for each player i.</p>
<p>We represent profiles with dependent finite-support functions (dffun)</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Profiles</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Implicit Type</span> (N : finType).</span></span></span></pre><p>Profile for classical games</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">    </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">profile</span> (<span class="nv">N</span> : finType) (<span class="nv">X</span> : N -&gt; eqType) := {dffun <span class="kr">forall</span> <span class="nv">i</span>, X i}.</span></span></span></pre><p>Finite profile</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">    </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">fprofile</span> <span class="nv">N</span> (<span class="nv">X</span> : N -&gt; finType) := {dffun <span class="kr">forall</span> <span class="nv">i</span>, X i}.</span></span></span></pre><p>Change the strategy of a given player in a given profile</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">    </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">move</span> <span class="nv">N</span> <span class="nv">X</span> (<span class="nv">p</span> : profile X) (<span class="nv">i</span> : N) (<span class="nv">pi</span> : X i) : profile X :=
      [ffun j =&gt; <span class="kr">match</span> boolP (i == j) <span class="kr">with</span>
                 | AltTrue h =&gt; eq_rect _ X pi _ (eqP h)
                 | AltFalse _ =&gt;  p j
                 <span class="kr">end</span>].</span></span></span></pre><p>Profile for incomplete games</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">    </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">iprofile</span> <span class="nv">N</span> (<span class="nv">T</span> : N -&gt; finType) (<span class="nv">X</span> : N -&gt; eqType) :=
      {dffun <span class="kr">forall</span> <span class="nv">i</span>, T i -&gt; X i}.</span></span></span></pre><p>Transform an iprofile to a profile such as support is the set of dependent pairs (i,t_i)</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">    </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">iprofile_flatten</span> <span class="nv">N</span> (<span class="nv">T</span> : N -&gt; finType) <span class="nv">X</span> (<span class="nv">p</span> : iprofile T X)
      : profile (<span class="kr">fun</span> <span class="nv">it</span> =&gt; X (projT1 it)) :=
      [ffun it =&gt; p (projT1 it) (projT2 it)].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">proj_iprofile</span> <span class="nv">N</span> (<span class="nv">T</span> : N -&gt; finType) <span class="nv">X</span> (<span class="nv">p</span> : iprofile T X)
      : profile T -&gt; profile X :=
      <span class="kr">fun</span> <span class="nv">theta</span> =&gt; [ffun i =&gt; p i (theta i)].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">proj_flatprofile</span> <span class="nv">N</span> (<span class="nv">T</span> : N -&gt; finType) <span class="nv">X</span>
               (<span class="nv">p</span> : profile (<span class="kr">fun</span> <span class="nv">it</span> =&gt; X (projT1 it)))
     : profile T -&gt; profile X :=
      <span class="kr">fun</span> <span class="nv">theta</span> =&gt; [ffun i =&gt; p (existT _ i (theta i))].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">proj_iprof_flatprof</span> <span class="nv">N</span> (<span class="nv">T</span> : N -&gt; finType) <span class="nv">X</span> (<span class="nv">p</span> : iprofile T X) <span class="nv">theta</span> :
      (proj_iprofile p theta) = (proj_flatprofile (iprofile_flatten p) theta).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">theta</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">proj_iprofile p theta =
proj_flatprofile (iprofile_flatten p) theta</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chka"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">theta</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">proj_iprofile p theta =
proj_flatprofile (iprofile_flatten p) theta</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: eq_dffun =&gt; i; <span class="nb">rewrite</span> ffunE.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">bmove</span> <span class="nv">N</span> <span class="nv">T</span> <span class="nv">X</span> (<span class="nv">p</span> : iprofile T X) (<span class="nv">i</span> : N) <span class="nv">ti</span> <span class="nv">xi</span>
      : iprofile T X :=
      [ffun j =&gt; <span class="kr">fun</span> <span class="nv">tj</span> =&gt; <span class="kr">match</span> boolP (i == j) <span class="kr">with</span>
                           | AltTrue h =&gt;
                             <span class="kr">let</span> <span class="nv">ti&#39;</span> := eq_rect _ T ti _ (eqP h) <span class="kr">in</span>
                               <span class="kr">if</span> ti&#39; == tj
                               <span class="kr">then</span> eq_rect i X xi j (eqP h)
                               <span class="kr">else</span> p j tj
                           | AltFalse _ =&gt; p j tj
                           <span class="kr">end</span>].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chkb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">move_bmove</span> <span class="nv">N</span> <span class="nv">T</span> <span class="nv">X</span> (<span class="nv">p</span> : iprofile T X) (<span class="nv">it</span> : {i : N &amp; T i})
          (<span class="nv">xi</span> : X (projT1 it)) :
      (@<span class="nb">move</span> _ _ (iprofile_flatten p) it xi)
      = (iprofile_flatten (bmove p (projT2 it) xi)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">move</span> (iprofile_flatten p) xi =
iprofile_flatten (bmove p (projT2 it) xi)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chkc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">move</span> (iprofile_flatten p) xi =
iprofile_flatten (bmove p (projT2 it) xi)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chkd"><span class="highlight"><span class="nb">apply</span> eq_dffun =&gt; it&#39; //=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> boolP (it == it&#39;) <span class="kr">with</span>
| @AltTrue _ _ h =&gt;
    eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x))
      xi it&#39; (eqP h)
| @AltFalse _ _ _ =&gt; iprofile_flatten p it&#39;
<span class="kr">end</span> = bmove p (projT2 it) xi (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chke"><span class="highlight"><span class="nb">rewrite</span> !ffunE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> boolP (it == it&#39;) <span class="kr">with</span>
| @AltTrue _ _ h =&gt;
    eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x))
      xi it&#39; (eqP h)
| @AltFalse _ _ _ =&gt; p (projT1 it&#39;) (projT2 it&#39;)
<span class="kr">end</span> =
<span class="kr">match</span> boolP (projT1 it == projT1 it&#39;) <span class="kr">with</span>
| @AltTrue _ _ h =&gt;
    <span class="kr">let</span> <span class="nv">ti&#39;</span> :=
      eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x)
        (projT2 it) (projT1 it&#39;) (eqP h) <span class="kr">in</span>
    <span class="kr">if</span> ti&#39; == projT2 it&#39;
    <span class="kr">then</span>
     eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
       (projT1 it&#39;) (eqP h)
    <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;)
| @AltFalse _ _ _ =&gt; p (projT1 it&#39;) (projT2 it&#39;)
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chkf"><span class="highlight"><span class="nb">case</span> (boolP (@eq_op (Finite.eqType (tag_finType T)) it it&#39;)) =&gt; H1 ;
    <span class="nb">case</span> (boolP (projT1 it == projT1 it&#39;)) =&gt; H2 //=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk10" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk10"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk11"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk12"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk13" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk13"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk14" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk14"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk15"><span class="highlight"><span class="nb">case</span> (boolP ((eq_rect _ _ (projT2 it) (projT1 it&#39;)  (@elimT
            (@eq (Finite.sort N) _ _) _ eqP H2)) == (projT2 it&#39;))) =&gt; H3.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) == projT2 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) =
eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi (projT1 it&#39;)
  (eqP H2)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk16" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) != projT2 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk16"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk17" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk17"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk18" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk18"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk19"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) == projT2 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) =
eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi (projT1 it&#39;)
  (eqP H2)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk1a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) != projT2 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk1a"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk1b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk1b"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk1c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk1c"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk1d"><span class="highlight"><span class="nb">rewrite</span> (rew_map X _ (eqP H1) xi).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) == projT2 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi (projT1 it&#39;)
  (<span class="nb">f_equal</span> (projT1 (P:=<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)) (eqP H1)) =
eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi (projT1 it&#39;)
  (eqP H2)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk1e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) != projT2 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk1e"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk1f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk1f"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk20" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk20"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk21"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> (Eqdep_dec.eq_proofs_unicity
           (@eqType_dec N) (<span class="nb">f_equal</span> _ (eqP H1))(eqP H2)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) != projT2 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk22" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk22"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk23" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk23"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk24"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) != projT2 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk25" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk25"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk26"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk27"><span class="highlight"><span class="nb">move</span>/eqP <span class="kr">in</span> H3.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) &lt;&gt; projT2 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk28" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk28"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk29" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk29"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk2a"><span class="highlight"><span class="nb">have</span> Hcontra := projT2_eq (eqP H1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) &lt;&gt; projT2 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hcontra</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">a</span> : N =&gt; T a)
  (projT2 it) (projT1 it&#39;)
  (projT1_eq (eqP H1)) = 
projT2 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk2b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk2b"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk2c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk2c"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) 
    (projT2 it) (projT1 it&#39;) 
    (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk2d"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> (Eqdep_dec.eq_proofs_unicity (@eqType_dec N)
                (projT1_eq (eqP H1)) (eqP H2)) <span class="kr">in</span> Hcontra.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk2e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk2e"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk2f"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it != projT1 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk30" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk30"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk31"><span class="highlight"><span class="nb">move</span>/eqP <span class="kr">in</span> H2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it == it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it &lt;&gt; projT1 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq_rect it (<span class="kr">fun</span> <span class="nv">x</span> : {i : N &amp; T i} =&gt; X (projT1 x)) xi
  it&#39; (eqP H1) = p (projT1 it&#39;) (projT2 it&#39;)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk32" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk32"><hr></label><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk33"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> (eqP H1) <span class="kr">in</span> H2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk34"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
(<span class="kr">if</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; T x) (projT2 it)
    (projT1 it&#39;) (eqP H2) == projT2 it&#39;
 <span class="kr">then</span>
  eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi
    (projT1 it&#39;) (eqP H2)
 <span class="kr">else</span> p (projT1 it&#39;) (projT2 it&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk35"><span class="highlight"><span class="nb">case</span> (boolP ((eq_rect _ _ (projT2 it) (projT1 it&#39;)  (@elimT
            (@eq (Finite.sort N) _ _) _ eqP H2)) == (projT2 it&#39;))) =&gt; H3 //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) == projT2 it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi (projT1 it&#39;)
  (eqP H2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk36"><span class="highlight"><span class="nb">have</span> Hcontra := eq_sigT it it&#39; (eqP H2) (eqP H3).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">T</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">N -&gt; eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile T X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : N &amp; T i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tag_finType T</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it != it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">projT1 it == projT1 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">i</span> : N =&gt; T i)
  (projT2 it) (projT1 it&#39;) (eqP H2) == projT2 it&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hcontra</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">it = it&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p (projT1 it&#39;) (projT2 it&#39;) =
eq_rect (projT1 it) (<span class="kr">fun</span> <span class="nv">x</span> : N =&gt; X x) xi (projT1 it&#39;)
  (eqP H2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>/eqP <span class="kr">in</span> H1.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Profiles</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Games</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">NFGame</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(* Classical SNF games *)</span>

</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">game</span> (<span class="nv">player</span> : finType) : <span class="kt">Type</span> :=
    { outcome : player -&gt; <span class="kt">Type</span> ;
      action : player -&gt; finType ;
      utility : <span class="kr">forall</span> <span class="nv">i</span>, profile action -&gt; outcome i ;
      preceq : <span class="kr">forall</span> <span class="nv">i</span>, rel (outcome i) ;
    }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">NashEqb</span> <span class="nv">player</span> (<span class="nv">g</span> : game player)
    : pred (profile (action g)) :=
    <span class="kr">fun</span> <span class="nv">p</span> =&gt;
    [<span class="kr">forall</span> <span class="nv">i</span> : player,
     <span class="kr">forall</span> <span class="nv">ai</span> : action g i,
        ~~ prec (@preceq _ _ _) (utility i p) (utility i (<span class="nb">move</span> p ai))].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">NashEq</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) (<span class="nv">p</span> : profile (action g))
    : <span class="kt">Prop</span> :=
    <span class="kr">forall</span> (<span class="nv">i</span> : player) (<span class="nv">ai</span> : action g i),
    ~ prec (@preceq _ _ _) (utility i p) (utility i (<span class="nb">move</span> p ai)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk37"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">NashEqP</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) (<span class="nv">p</span> : profile (action g)) :
    reflect (NashEq p) (NashEqb p).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (NashEq p) (NashEqb p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk38"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (NashEq p) (NashEqb p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk39"><span class="highlight"><span class="nb">case</span> (boolP (NashEqb p)) ; <span class="nb">constructor</span> ; <span class="nb">move</span>: i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NashEqb p -&gt; NashEq p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk3a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk3a"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk3b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NashEqb p -&gt; NashEq p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk3c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk3c"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk3d"><span class="highlight"><span class="nb">move</span>/forallP =&gt; H i ; <span class="nb">move</span>: (H i).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : player,
[<span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq (i:=x)) 
     (utility x p) (utility x (<span class="nb">move</span> p ai))]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[<span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq (i:=i)) (utility i p)
     (utility i (<span class="nb">move</span> p ai))] -&gt;
<span class="kr">forall</span> <span class="nv">ai</span> : action g i,
~
prec (preceq (i:=i)) (utility i p)
  (utility i (<span class="nb">move</span> p ai))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk3e"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk3f"><span class="highlight"><span class="nb">move</span>/forallP =&gt; H2 ai ; <span class="nb">move</span>: (H2 ai) =&gt; H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : player,
[<span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq (i:=x)) 
     (utility x p) (utility x (<span class="nb">move</span> p ai))]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : action g i,
~~
prec (preceq (i:=i)) (utility i p)
  (utility i (<span class="nb">move</span> p x))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ai</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">action g i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~
prec (preceq (i:=i)) (utility i p)
  (utility i (<span class="nb">move</span> p ai))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~
prec (preceq (i:=i)) (utility i p)
  (utility i (<span class="nb">move</span> p ai))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk40" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk40"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk41"><span class="highlight"><span class="bp">exact</span>: (negP H0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk42"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk43"><span class="highlight"><span class="nb">move</span>/forallPn =&gt; [] x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~
[<span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq (i:=x)) (utility x p)
     (utility x (<span class="nb">move</span> p ai))] -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk44"><span class="highlight"><span class="nb">move</span>/forallPn =&gt; [] y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">action g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~
~~
prec (preceq (i:=x)) (utility x p)
  (utility x (<span class="nb">move</span> p y)) -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk45"><span class="highlight"><span class="nb">move</span>/negPn =&gt; [H Hne].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">Nothing to inject.</span></blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">action g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">prec (preceq (i:=x)) (utility x p)
  (utility x (<span class="nb">move</span> p y))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hne</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">NashEq p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>: (Hne x y).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">NFGame</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">HGGame</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(* Hyper-graphical games with player-dependant-oplus-operator *)</span>

</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">game</span> (<span class="nv">player</span> : finType) : <span class="kt">Type</span> :=
    { local_game : finType ;
      plays : local_game -&gt; pred player ;
      outcome : player -&gt; <span class="kt">Type</span> ;
      outcome0 : <span class="kr">forall</span> <span class="nv">i</span>, outcome i ;
      oplus : <span class="kr">forall</span> <span class="nv">i</span>, Monoid.com_law (outcome0 i) ;
      preceq : <span class="kr">forall</span> <span class="nv">i</span>, rel (outcome i) ;
      action : player -&gt; finType ;
      local_utility : local_game -&gt;
                      <span class="kr">forall</span> <span class="nv">i</span>, profile action -&gt; outcome i ;
    }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">global_utility</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) (<span class="nv">i</span> : player)
             (<span class="nv">p</span> : profile (action g)) :=
    \big[oplus g i/outcome0 g i]_(lg : local_game g | plays lg i)
     local_utility lg i p.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">to_normal_form</span> <span class="nv">player</span> (<span class="nv">g</span> : game player)
    : NFGame.game player :=
    {| NFGame.outcome := outcome g ;
       NFGame.preceq := @preceq _ g ;
       NFGame.action := action g ;
       NFGame.utility := @global_utility _ g ;
    |}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">NashEqb</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) :=
    @NFGame.NashEqb _ (to_normal_form g).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">NashEq</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) :=
    @NFGame.NashEq _ (to_normal_form g).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk46"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">NashEqP</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) (<span class="nv">p</span> : profile (action g))
    : reflect (NashEq p) (NashEqb p).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (NashEq p) (NashEqb p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk47"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (NashEq p) (NashEqb p)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span>: NFGame.NashEqP.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk48"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">NashEq_HG_NFb</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) <span class="nv">p</span> :
    NashEqb p = @NFGame.NashEqb _ (to_normal_form g) p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt;
   NFGame.action (to_normal_form g) x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NashEqb p = NFGame.NashEqb p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk49"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt;
   NFGame.action (to_normal_form g) x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NashEqb p = NFGame.NashEqb p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> [].</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk4a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">nashEq_HG_NF</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) <span class="nv">p</span> :
    NashEq p &lt;-&gt; @NFGame.NashEq _ (to_normal_form g) p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt;
   NFGame.action (to_normal_form g) x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NashEq p &lt;-&gt; NFGame.NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk4b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">profile
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt;
   NFGame.action (to_normal_form g) x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NashEq p &lt;-&gt; NFGame.NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> [].</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">HGGame</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">IGame</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(* Incomplete games such as Bayesian games and possibilistic games *)</span>

</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">game</span> (<span class="nv">player</span> : finType) : <span class="kt">Type</span> :=
    { evalst : player -&gt; eval_struct ;
      signal : player -&gt; finType ;
      action : player -&gt; finType ;
      utility : <span class="kr">forall</span> <span class="nv">i</span> : player,
        profile action -&gt; profile signal -&gt; U (evalst i) ;
      belief : <span class="kr">forall</span> <span class="nv">i</span> : player, profile signal -&gt; W (evalst i) ;
    }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">GEutility</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) (<span class="nv">i</span> : player) <span class="nv">t</span> <span class="nv">p</span> :=
    \big[oplus (evalst g i)/V0 (evalst g i)]_(
     theta : fprofile (signal g) | (theta i) == t)
     otimes (belief i theta) (utility i (proj_iprofile p theta) theta).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">to_hggame</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) : HGGame.game _ :=
    {| HGGame.local_game := [finType of fprofile (signal g)] ;
       HGGame.plays := <span class="kr">fun</span> <span class="nv">theta</span> <span class="nv">it</span> =&gt; theta (projT1 it) == projT2 it ;
       HGGame.outcome := <span class="kr">fun</span> <span class="nv">it</span> =&gt; V _ ;
       HGGame.outcome0 := <span class="kr">fun</span> <span class="nv">it</span> =&gt; V0 _ ;
       HGGame.oplus := <span class="kr">fun</span> <span class="nv">it</span> =&gt; oplus _ ;
       HGGame.preceq := <span class="kr">fun</span> <span class="nv">it</span> =&gt; @preceq_V _ ;
       HGGame.action := <span class="kr">fun</span> <span class="nv">it</span> =&gt; action g _ ;
       HGGame.local_utility := <span class="kr">fun</span> <span class="nv">theta</span> <span class="nv">it</span> <span class="nv">p</span> =&gt;
           otimes (belief (projT1 it) theta)
              (utility (projT1 it) (proj_flatprofile p theta) theta) ;
    |}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">to_normal_form</span> <span class="nv">player</span> (<span class="nv">g</span> : game player)
    : NFGame.game _ :=
    HGGame.to_normal_form (to_hggame g).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">NashEqb</span> <span class="nv">player</span> (<span class="nv">g</span> : game player)
    : pred (iprofile (signal g) (action g)) :=
    <span class="kr">fun</span> <span class="nv">bp</span> =&gt;
    [<span class="kr">forall</span> <span class="nv">i</span> : player,
     <span class="kr">forall</span> <span class="nv">t</span> : signal g i,
     <span class="kr">forall</span> <span class="nv">ai</span> : action g i,
          ~~ prec (@preceq_V _) (GEutility t bp)
             (GEutility t (bmove bp t ai)) ].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">NashEq</span> <span class="nv">player</span> (<span class="nv">g</span> : game player) <span class="nv">p</span> : <span class="kt">Prop</span> :=
    <span class="kr">forall</span> <span class="nv">i</span> : player,
    <span class="kr">forall</span> <span class="nv">t</span> : signal g i,
    <span class="kr">forall</span> <span class="nv">ai</span> : action g i,
    ~ prec (@preceq_V _) (GEutility t p) (GEutility t (bmove p t ai)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk4c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">NashEqP</span> <span class="nv">player</span> (<span class="nv">g</span> : game player)
        (<span class="nv">p</span> : iprofile (signal g) (action g)) :
    reflect (NashEq p) (NashEqb p).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (NashEq p) (NashEqb p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk4d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (NashEq p) (NashEqb p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk4e"><span class="highlight"><span class="nb">case</span> (boolP (NashEqb p)) ; <span class="nb">constructor</span> ; <span class="nb">move</span>: i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NashEqb p -&gt; NashEq p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk4f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk4f"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk50"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NashEqb p -&gt; NashEq p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk51" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk51"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk52"><span class="highlight"><span class="nb">move</span>/forallP =&gt; H i ; <span class="nb">move</span>: (H i).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : player,
[<span class="kr">forall</span> <span class="nv">t</span>,
   <span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g x)) 
     (GEutility t p) (GEutility t (bmove p t ai))]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[<span class="kr">forall</span> <span class="nv">t</span>,
   <span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g i)) (GEutility t p)
     (GEutility t (bmove p t ai))] -&gt;
<span class="kr">forall</span> (<span class="nv">t</span> : signal g i) (<span class="nv">ai</span> : action g i),
~
prec (preceq_V (e:=evalst g i)) (GEutility t p)
  (GEutility t (bmove p t ai))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk53" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk53"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk54"><span class="highlight"><span class="nb">move</span>/forallP =&gt; H2 t ; <span class="nb">move</span>: (H2 t).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : player,
[<span class="kr">forall</span> <span class="nv">t</span>,
   <span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g x)) 
     (GEutility t p) (GEutility t (bmove p t ai))]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : signal g i,
[<span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g i))
     (GEutility x p) (GEutility x (bmove p x ai))]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">signal g i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[<span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g i)) (GEutility t p)
     (GEutility t (bmove p t ai))] -&gt;
<span class="kr">forall</span> <span class="nv">ai</span> : action g i,
~
prec (preceq_V (e:=evalst g i)) (GEutility t p)
  (GEutility t (bmove p t ai))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk55" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk55"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk56"><span class="highlight"><span class="nb">move</span>/forallP =&gt; H3 ai ; <span class="nb">move</span>: (H3 ai) =&gt; H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : player,
[<span class="kr">forall</span> <span class="nv">t</span>,
   <span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g x)) 
     (GEutility t p) (GEutility t (bmove p t ai))]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : signal g i,
[<span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g i))
     (GEutility x p) (GEutility x (bmove p x ai))]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">signal g i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : action g i,
~~
prec (preceq_V (e:=evalst g i)) 
  (GEutility t p) (GEutility t (bmove p t x))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ai</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">action g i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~
prec (preceq_V (e:=evalst g i)) 
  (GEutility t p) (GEutility t (bmove p t ai))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~
prec (preceq_V (e:=evalst g i)) (GEutility t p)
  (GEutility t (bmove p t ai))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk57" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk57"><hr></label><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk58"><span class="highlight"><span class="bp">exact</span>: negP H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk59"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ NashEqb p -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk5a"><span class="highlight"><span class="nb">move</span>/forallPn =&gt; [] x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~
[<span class="kr">forall</span> <span class="nv">t</span>,
   <span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g x)) (GEutility t p)
     (GEutility t (bmove p t ai))] -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk5b"><span class="highlight"><span class="nb">move</span>/forallPn =&gt; [] y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">signal g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~
[<span class="kr">forall</span> <span class="nv">ai</span>,
   ~~
   prec (preceq_V (e:=evalst g x)) (GEutility y p)
     (GEutility y (bmove p y ai))] -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk5c"><span class="highlight"><span class="nb">move</span>/forallPn =&gt; [] z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">signal g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">action g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~
~~
prec (preceq_V (e:=evalst g x)) (GEutility y p)
  (GEutility y (bmove p y z)) -&gt; ~ NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk5d"><span class="highlight"><span class="nb">move</span>/negPn =&gt; H2 Hne.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (signal g) (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">signal g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">action g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">prec (preceq_V (e:=evalst g x)) 
  (GEutility y p) (GEutility y (bmove p y z))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hne</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">NashEq p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>/(_ x y z) <span class="kr">in</span> Hne.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">IGame</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">HR</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk5e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">HowsonRosenthal</span> :
    <span class="kr">forall</span> <span class="nv">player</span> (<span class="nv">g</span> : IGame.game player) <span class="nv">i</span> <span class="nv">t</span> <span class="nv">p</span>,
    @IGame.GEutility player g i t p
    = @HGGame.global_utility _ (IGame.to_hggame g) (existT _ i t)
                             (iprofile_flatten p).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">player</span> : finType) (<span class="nv">g</span> : IGame.game player)
  (<span class="nv">i</span> : player) (<span class="nv">t</span> : IGame.signal g i)
  (<span class="nv">p</span> : iprofile (IGame.signal g)
         (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)),
IGame.GEutility t p =
HGGame.global_utility
  (existT (<span class="kr">fun</span> <span class="nv">i0</span> : player =&gt; IGame.signal g i0) i t)
  (iprofile_flatten p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk5f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">player</span> : finType) (<span class="nv">g</span> : IGame.game player)
  (<span class="nv">i</span> : player) (<span class="nv">t</span> : IGame.signal g i)
  (<span class="nv">p</span> : iprofile (IGame.signal g)
         (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)),
IGame.GEutility t p =
HGGame.global_utility
  (existT (<span class="kr">fun</span> <span class="nv">i0</span> : player =&gt; IGame.signal g i0) i t)
  (iprofile_flatten p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk60"><span class="highlight"><span class="nb">rewrite</span> /IGame.GEutility /HGGame.global_utility
          /IGame.to_hggame =&gt; player g i t p //=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.signal g i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\big[oplus (IGame.evalst g i)/V0 (IGame.evalst g i)]_(theta | 
theta i == t)
   otimes (IGame.belief i theta)
     (IGame.utility i (proj_iprofile p theta) theta) =
\big[oplus (IGame.evalst g i)/V0 (IGame.evalst g i)]_(lg | 
lg i == t)
   otimes (IGame.belief i lg)
     (IGame.utility i
        (proj_flatprofile (iprofile_flatten p) lg) lg)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk61"><span class="highlight"><span class="nb">apply</span> eq_bigr =&gt; theta Htheta.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.signal g i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">theta</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fprofile (IGame.signal g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Htheta</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">theta i == t</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">otimes (IGame.belief i theta)
  (IGame.utility i (proj_iprofile p theta) theta) =
otimes (IGame.belief i theta)
  (IGame.utility i
     (proj_flatprofile (iprofile_flatten p) theta)
     theta)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -proj_iprof_flatprof.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk62"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">HowsonRosenthal_NashEqb</span> :
    <span class="kr">forall</span> <span class="nv">player</span> (<span class="nv">g</span> : IGame.game player),
    <span class="kr">forall</span>  (<span class="nv">p</span> : iprofile (IGame.signal g) (IGame.action g)),
    @HGGame.NashEqb _ (IGame.to_hggame g) (iprofile_flatten p)
    = IGame.NashEqb p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">player</span> : finType) (<span class="nv">g</span> : IGame.game player)
  (<span class="nv">p</span> : iprofile (IGame.signal g)
         (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)),
HGGame.NashEqb (iprofile_flatten p) = IGame.NashEqb p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk63"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">player</span> : finType) (<span class="nv">g</span> : IGame.game player)
  (<span class="nv">p</span> : iprofile (IGame.signal g)
         (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)),
HGGame.NashEqb (iprofile_flatten p) = IGame.NashEqb p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk64"><span class="highlight"><span class="nb">move</span> =&gt; player g p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">HGGame.NashEqb (iprofile_flatten p) = IGame.NashEqb p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk65"><span class="highlight"><span class="nb">apply</span>/NFGame.NashEqP /IGame.NashEqP =&gt; /=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NFGame.NashEq (iprofile_flatten p) -&gt; IGame.NashEq p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk66" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk66"><hr></label><div class="goal-conclusion"><span class="highlight">IGame.NashEq p -&gt; NFGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk67"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">NFGame.NashEq (iprofile_flatten p) -&gt; IGame.NashEq p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk68" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk68"><hr></label><div class="goal-conclusion"><span class="highlight">IGame.NashEq p -&gt; NFGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk69"><span class="highlight"><span class="nb">rewrite</span> /NFGame.NashEq /IGame.NashEq =&gt; /= H i t ai.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : {i : player &amp; IGame.signal g i})
  (<span class="nv">ai</span> : IGame.action g (projT1 i)),
~
prec (preceq_V (e:=IGame.evalst g (projT1 i)))
  (HGGame.global_utility i (iprofile_flatten p))
  (HGGame.global_utility i
     (<span class="nb">move</span> (iprofile_flatten p) ai))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.signal g i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ai</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.action g i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~
prec (preceq_V (e:=IGame.evalst g i))
  (IGame.GEutility t p)
  (IGame.GEutility t (bmove p t ai))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk6a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk6a"><hr></label><div class="goal-conclusion"><span class="highlight">IGame.NashEq p -&gt; NFGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk6b"><span class="highlight"><span class="nb">move</span> : (H (existT _ i t) ai).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : {i : player &amp; IGame.signal g i})
  (<span class="nv">ai</span> : IGame.action g (projT1 i)),
~
prec (preceq_V (e:=IGame.evalst g (projT1 i)))
  (HGGame.global_utility i (iprofile_flatten p))
  (HGGame.global_utility i
     (<span class="nb">move</span> (iprofile_flatten p) ai))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.signal g i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ai</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.action g i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~
prec
  (preceq_V
     (e:=IGame.evalst g
           (projT1
              (existT
                 (<span class="kr">fun</span> <span class="nv">i</span> : player =&gt; IGame.signal g i)
                 i t))))
  (HGGame.global_utility
     (existT (<span class="kr">fun</span> <span class="nv">i</span> : player =&gt; IGame.signal g i) i t)
     (iprofile_flatten p))
  (HGGame.global_utility
     (existT (<span class="kr">fun</span> <span class="nv">i</span> : player =&gt; IGame.signal g i) i t)
     (<span class="nb">move</span> (iprofile_flatten p) ai)) -&gt;
~
prec (preceq_V (e:=IGame.evalst g i))
  (IGame.GEutility t p)
  (IGame.GEutility t (bmove p t ai))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk6c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk6c"><hr></label><div class="goal-conclusion"><span class="highlight">IGame.NashEq p -&gt; NFGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk6d"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> {<span class="mi">1</span>}/iprofile_flatten !HowsonRosenthal move_bmove.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IGame.NashEq p -&gt; NFGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk6e"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IGame.NashEq p -&gt; NFGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk6f"><span class="highlight"><span class="nb">rewrite</span> /NFGame.NashEq /IGame.NashEq =&gt; /= H it ai.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : player) (<span class="nv">t</span> : IGame.signal g i)
  (<span class="nv">ai</span> : IGame.action g i),
~
prec (preceq_V (e:=IGame.evalst g i))
  (IGame.GEutility t p)
  (IGame.GEutility t (bmove p t ai))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : player &amp; IGame.signal g i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ai</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.action g (projT1 it)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~
prec (preceq_V (e:=IGame.evalst g (projT1 it)))
  (HGGame.global_utility it (iprofile_flatten p))
  (HGGame.global_utility it
     (<span class="nb">move</span> (iprofile_flatten p) ai))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk70"><span class="highlight"><span class="nb">have</span> H&#39; := (H (projT1 it) (projT2 it) ai).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : player) (<span class="nv">t</span> : IGame.signal g i)
  (<span class="nv">ai</span> : IGame.action g i),
~
prec (preceq_V (e:=IGame.evalst g i))
  (IGame.GEutility t p)
  (IGame.GEutility t (bmove p t ai))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">it</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{i : player &amp; IGame.signal g i}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ai</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.action g (projT1 it)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
prec (preceq_V (e:=IGame.evalst g (projT1 it)))
  (IGame.GEutility (projT2 it) p)
  (IGame.GEutility (projT2 it)
     (bmove p (projT2 it) ai))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~
prec (preceq_V (e:=IGame.evalst g (projT1 it)))
  (HGGame.global_utility it (iprofile_flatten p))
  (HGGame.global_utility it
     (<span class="nb">move</span> (iprofile_flatten p) ai))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> {<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span>}(sigT_eta it) move_bmove -!HowsonRosenthal.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk71"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">HowsonRosenthal_NashEq</span> :
    <span class="kr">forall</span> <span class="nv">player</span> (<span class="nv">g</span> : IGame.game player),
    <span class="kr">forall</span>  (<span class="nv">p</span> : iprofile (IGame.signal g) (IGame.action g)),
    @HGGame.NashEq _ (IGame.to_hggame g) (iprofile_flatten p)
    &lt;-&gt; IGame.NashEq p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">player</span> : finType) (<span class="nv">g</span> : IGame.game player)
  (<span class="nv">p</span> : iprofile (IGame.signal g)
         (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)),
HGGame.NashEq (iprofile_flatten p) &lt;-&gt; IGame.NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk72"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">player</span> : finType) (<span class="nv">g</span> : IGame.game player)
  (<span class="nv">p</span> : iprofile (IGame.signal g)
         (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)),
HGGame.NashEq (iprofile_flatten p) &lt;-&gt; IGame.NashEq p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk73"><span class="highlight"><span class="nb">split</span> =&gt; H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HGGame.NashEq (iprofile_flatten p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IGame.NashEq p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk74" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.NashEq p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk74"><hr></label><div class="goal-conclusion"><span class="highlight">HGGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk75"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HGGame.NashEq (iprofile_flatten p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IGame.NashEq p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk76" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.NashEq p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk76"><hr></label><div class="goal-conclusion"><span class="highlight">HGGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk77"><span class="highlight"><span class="nb">apply</span>/IGame.NashEqP ; <span class="nb">move</span>/HGGame.NashEqP <span class="kr">in</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HGGame.NashEqb (iprofile_flatten p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IGame.NashEqb p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="algebraic-hr-v-chk78" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.NashEq p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="algebraic-hr-v-chk78"><hr></label><div class="goal-conclusion"><span class="highlight">HGGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk79"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -(HowsonRosenthal_NashEqb p).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.NashEq p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">HGGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk7a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.NashEq p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">HGGame.NashEq (iprofile_flatten p)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="algebraic-hr-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="algebraic-hr-v-chk7b"><span class="highlight"><span class="nb">apply</span>/HGGame.NashEqP ; <span class="nb">move</span>/IGame.NashEqP <span class="kr">in</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">player</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.game player</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">iprofile (IGame.signal g)
  (<span class="kr">fun</span> <span class="nv">x</span> : player =&gt; IGame.action g x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IGame.NashEqb p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">HGGame.NashEqb (iprofile_flatten p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> (HowsonRosenthal_NashEqb p).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">HR</span>.</span></span></span></pre></div>
</div>
</div>
</div>
</div></body>
</html>
